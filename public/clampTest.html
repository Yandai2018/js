<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Use correct character set. -->
    <meta charset="utf-8">
    <!-- Tell IE to use the latest, best version. -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Make the application on mobile take up the full browser screen and disable user scaling. -->
    <meta name="viewport"
          content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
    <title>Hello World!</title>
    <script src="cesium/Cesium.js"></script>
    <style>
        @import url(cesium/Widgets/widgets.css);
        @import url(cesium/bucket.css);

        html, body, #cesiumContainer {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
    </style>
</head>
<body>
<div id="cesiumContainer"></div>
<script>
    var viewer = new Cesium.Viewer('cesiumContainer', {
        shouldAnimate: true,
        homeButton: false,       //是否显示home键
       // baseLayerPicker: false, //是否显示图层选择控件d
        timeline: false,        //是否显示时间线控件
        fullscreenButton: false, //是否全屏显示
        scene3DOnly: true,     //如果设置为true，则所有几何图形以3D模式绘制以节约GPU资源
        infoBox: true,         //是否显示点击要素之后显示的信息
        sceneModePicker: false,  //是否显示投影方式控件  三维/二维
        navigationInstructionsInitiallyVisible: false,
        navigationHelpButton: false,     //是否显示帮助信息控件
        selectionIndicator: false,        //是否显示指示器组件
        terrainProvider: Cesium.createWorldTerrain()
    });
    var scene = viewer.scene;
    var clock = viewer.clock;
    // var ellipsoid = viewer.scene.globe.ellipsoid;
    // var cartesian3 = new Cesium.cartesian3(1216348.1632364073,-4736348.958775471,4081284.5528982095);
    // var cartographic = ellipsoid.cartesianToCartographic(cartesian3);
    // var lat = Cesium.Math.toDegrees(cartograhphic.latitude);
    // var lng = Cesium.Math.toDegrees(cartograhpinc.longitude);
    // var alt = cartographic.height;
    var ellipsoid = viewer.scene.globe.ellipsoid;
    var cartographic = Cesium.Cartographic.fromDegrees(-78.00190569,36.99962837,6);
    var cartesian3 = ellipsoid.cartographicToCartesian(cartographic);
    console.log(cartesian3.x + "," + cartesian3.y + "," + cartesian3.z + ",");


    var entity;
    var positionProperty;
    var czml1 = [
        {
            "id": "document",
            "version": "1.0",
            "clock": {
                "interval": "2018-07-19T15:18:00Z/2018-07-19T15:18:30Z",
                "currentTime": "2018-07-19T15:18:00Z",
                "multiplier": 5,
                "range": "LOOP_STOP",
                "step": "SYSTEM_CLOCK_MULTIPLIER"
            }
        },
        {
            "id": "CesiumMilkTruck",
            "model": {
                "gltf": "cesium/Models//CesiumMilkTruck/CesiumMilkTruck.gltf"
            },
            "position": {
                "interpolationAlgorithm": "LINEAR",
                "forwardExtrapolationType": "HOLD",
                "cartesian": [
                    "2018-07-19T15:18:00Z",
                    1060147.49466802, -4988639.096137246, 3817344.3420725837,
                    "2018-07-19T15:18:30Z",
                    1060188.2574699132, -4988610.365637205, 3817363.7449174877
                ]
            }
        },
        {
            "id": "Polyline",
            "polyline": {
                "positions": {
                    "cartesian": [
                        1216348.1632364073,
                        -4736348.958775471,
                        4081284.5528982095,
                        1216369.1229444197,
                        -4736377.467107148,
                        4081240.888485707
                    ]
                },
                "material": {
                    "polylineOutline": {
                        "color": {
                            "rgba": [255, 255, 0, 255]
                        },
                        "outlineColor": {
                            "rgba": [0, 0, 0, 255]
                        },
                        "outlineWidth": 2
                    }
                },
                "width": 10,
                "clampToGround": true
            }
        }
    ];
    var dataSourcePromise = Cesium.CzmlDataSource.load(czml1);
    viewer.dataSources.add(dataSourcePromise).then(function (dataSource) {
        entity = dataSource.entities.getById('CesiumMilkTruck');
        entity.orientation = new Cesium.VelocityOrientationProperty(entity.position);
        positionProperty = entity.position;
        if (scene.clampToHeightSupported) {
            clock.shouldAnimate = true;
            var objectsToExclude = [entity];
            scene.postRender.addEventListener(function () {
                var position = positionProperty.getValue(clock.currentTime);
                entity.position = scene.clampToHeight(position, objectsToExclude);
            });
        } else {
            console.log('This browser does not support clampToHeight.');
        }
    });

    // var tileset = scene.primitives.add(
    //     new Cesium.Cesium3DTileset({
    //         url: Cesium.IonResource.fromAssetId(6074)
    //     })
    // );

    viewer.camera.setView({
        destination: new Cesium.Cartesian3(1060203.863393312, -4988683.797757099, 3817420.3150414284),
        orientation: new Cesium.HeadingPitchRoll(4.2892217081808806, -0.4799070147502502, 6.279789177843313),
        endTransform: Cesium.Matrix4.IDENTITY
    });
</script>
</body>
</html>
